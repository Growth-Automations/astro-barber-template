---
import type { CollectionEntry } from 'astro:content';
import { render } from 'astro:content';
import { resolveImage } from '../../lib/resolve-image';

export interface Props {
  entry: CollectionEntry<'blog'>;
}

const { entry } = Astro.props as Props;
const imageSrc = resolveImage(entry.data.image?.src);
const { Content } = await render(entry);
const publishedDate = new Date(entry.data.publishedAt).toLocaleDateString('en-US', {
  month: 'long',
  day: 'numeric',
  year: 'numeric'
});
---

<article class="space-y-10">
  <header class="space-y-4">
    <p class="text-xs font-semibold uppercase tracking-[0.35em] text-secondary">{entry.data.category}</p>
    <h1 class="text-4xl font-semibold text-text md:text-5xl">{entry.data.title}</h1>
    <div class="flex flex-wrap items-center gap-4 text-sm text-text-muted">
      <span>{publishedDate}</span>
      {entry.data.author && (
        <span>
          {entry.data.author.name}
          {entry.data.author.role && ` Â· ${entry.data.author.role}`}
        </span>
      )}
    </div>
  </header>
  {imageSrc && (
    <div class="overflow-hidden rounded-[32px]">
      <img class="h-full w-full object-cover" src={imageSrc} alt={entry.data.image?.alt ?? entry.data.title} loading="lazy" />
    </div>
  )}
  <div class="prose max-w-none">
    <Content />
  </div>
</article>
