---
import { resolveImage } from '../../lib/resolve-image';

export interface ServiceProcessStep {
  title: string;
  description: string;
  duration?: string;
}

export interface ServiceProcessProps {
  eyebrow?: string;
  title: string;
  description?: string;
  steps: ServiceProcessStep[];
  image?: {
    src: string;
    alt?: string;
  };
}

const props = Astro.props as ServiceProcessProps;
const processImage = resolveImage(props.image?.src);
const containerColumns = processImage ? 'lg:grid-cols-[1.05fr_0.95fr]' : '';
---

<section class="bg-surface-alt py-20 text-text">
  <div class={`mx-auto grid max-w-6xl gap-12 px-4 sm:px-6 lg:px-8 ${containerColumns}`}>
    <div class="space-y-6">
      {props.eyebrow && (
        <p class="text-xs font-semibold uppercase tracking-[0.35em] text-primary">{props.eyebrow}</p>
      )}
      <div class="space-y-4">
        <h2 class="text-3xl font-semibold tracking-tight text-text md:text-4xl">{props.title}</h2>
        {props.description && <p class="max-w-2xl text-base text-text-secondary">{props.description}</p>}
      </div>
      {props.steps?.length ? (
        <ol class="space-y-4">
          {props.steps.map((step, index) => (
            <li class="group flex gap-4 rounded-3xl border border-border bg-surface/80 p-5 shadow-sm backdrop-blur transition hover:border-primary/40 hover:shadow-lg">
              <div class="flex h-12 w-12 items-center justify-center rounded-2xl border border-primary/20 bg-primary/10 font-semibold text-primary">
                {String(index + 1).padStart(2, '0')}
              </div>
              <div class="space-y-1">
                <h3 class="text-lg font-semibold text-text">{step.title}</h3>
                <p class="text-sm text-text-secondary">{step.description}</p>
                {step.duration && (
                  <p class="text-xs font-medium uppercase tracking-[0.3em] text-text-muted">{step.duration}</p>
                )}
              </div>
            </li>
          ))}
        </ol>
      ) : (
        <div class="rounded-3xl border border-dashed border-border bg-surface/50 p-6 text-sm text-text-muted">
          Service process steps coming soon.
        </div>
      )}
    </div>
    {processImage && (
      <div class="relative overflow-hidden rounded-[32px] border border-border bg-surface shadow-xl">
        <div class="absolute inset-0 bg-gradient-to-t from-black/30 via-transparent to-transparent" />
        <img class="h-full w-full object-cover" src={processImage} alt={props.image?.alt ?? ''} loading="lazy" />
        <div class="pointer-events-none absolute inset-x-6 bottom-6 rounded-2xl border border-border bg-surface/80 px-5 py-4 text-sm text-text backdrop-blur">
          <p class="font-semibold text-text">Every service begins with a custom consultation.</p>
          <p class="mt-2 text-text-secondary">We tailor each step to your lifestyle, hair history, and goals.</p>
        </div>
      </div>
    )}
  </div>
</section>
